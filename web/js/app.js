"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),OfficeFetcher=function(){function e(){_classCallCheck(this,e),this.offices=[],this.place=null,this.view=$(".results > ul"),this.isOpenInWeekends=$("#is_open_in_weekends"),this.hasSupportDesk=$("#has_support_desk")}return _createClass(e,[{key:"fetchOffices",value:function(e){var t=this;this.clearView(),this.startLoading(),this.place=e;var i,n=this.isOpenInWeekends.is(":checked"),a=this.hasSupportDesk.is(":checked");i=e.vicinity?{city:e.vicinity,lat:e.geometry.location.lat(),"long":e.geometry.location.lng(),is_open_in_weekends:n,has_support_desk:a}:{city:e.name,is_open_in_weekends:n,has_support_desk:a},$.ajax({url:"api/v1/offices/search",type:"get",data:i,success:function(e){t.offices=e,t.populateView()},error:function(e){console.log(e)}})}},{key:"clearView",value:function(){this.view.html("")}},{key:"startLoading",value:function(){$("#loading").show()}},{key:"stopLoading",value:function(){$("#loading").hide()}},{key:"populateView",value:function(){this.stopLoading();var e="",t=!0,i=!1,n=void 0;try{for(var a,s=this.offices[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var o=a.value;e+='<a target="_blank" href="https://maps.google.com/maps?q='+o.latitude+","+o.longitude+'" class="list-group-item">Kantoor te '+o.street+", "+o.city,"undefined"!=typeof o.distance&&(e+='<span class="pull-right">'+parseFloat(o.distance).toFixed(2)+" km away</span>"),e+="</a>"}}catch(c){i=!0,n=c}finally{try{!t&&s["return"]&&s["return"]()}finally{if(i)throw n}}this.view.html(e)}},{key:"refetch",value:function(){this.place&&this.fetchOffices(this.place)}}]),e}();$(document).ready(function(){function e(){var e=document.getElementById("searchTextField"),i=new google.maps.places.Autocomplete(e);google.maps.event.addListener(i,"place_changed",function(){var e=i.getPlace();t.fetchOffices(e)})}var t=new OfficeFetcher;google.maps.event.addDomListener(window,"load",e),$("#searchForm").submit(function(e){e.preventDefault()}),$(".office-condition").on("click",function(){t.refetch()})});