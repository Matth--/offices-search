"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),OfficeFetcher=function(){function e(){_classCallCheck(this,e),this.offices=[],this.place=null,this.view=$(".results > ul"),this.isOpenInWeekends=$("#is_open_in_weekends"),this.hasSupportDesk=$("#has_support_desk")}return _createClass(e,[{key:"fetchOffices",value:function(e){var t=this;this.clearView(),this.startLoading(),this.place=e;var n,i=this.isOpenInWeekends.is(":checked"),a=this.hasSupportDesk.is(":checked");n=e.vicinity?{city:e.vicinity,lat:e.geometry.location.lat(),"long":e.geometry.location.lng(),is_open_in_weekends:i,has_support_desk:a}:{city:e.name,is_open_in_weekends:i,has_support_desk:a},console.log(n),$.ajax({url:"api/v1/offices/search",type:"get",data:n,success:function(e){t.offices=e,t.populateView()},error:function(e){console.log(e)}})}},{key:"clearView",value:function(){this.view.html("")}},{key:"startLoading",value:function(){$("#loading").show()}},{key:"stopLoading",value:function(){$("#loading").hide()}},{key:"populateView",value:function(){this.stopLoading();var e="",t=!0,n=!1,i=void 0;try{for(var a,o=this.offices[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var s=a.value;console.log(s),e+='<a href="#" class="list-group-item">Kantoor te '+s.street+", "+s.city,"undefined"!=typeof s.distance&&(e+='<span class="pull-right">'+parseFloat(s.distance).toFixed(2)+" km away</span>"),e+="</a>"}}catch(c){n=!0,i=c}finally{try{!t&&o["return"]&&o["return"]()}finally{if(n)throw i}}this.view.html(e)}},{key:"refetch",value:function(){this.place&&(console.log(this.place),this.fetchOffices(this.place))}}]),e}();$(document).ready(function(){function e(){var e=document.getElementById("searchTextField"),n=new google.maps.places.Autocomplete(e);google.maps.event.addListener(n,"place_changed",function(){var e=n.getPlace();t.fetchOffices(e)})}var t=new OfficeFetcher;google.maps.event.addDomListener(window,"load",e),$("#searchForm").submit(function(e){e.preventDefault()}),$(".office-condition").on("click",function(){t.refetch()})});